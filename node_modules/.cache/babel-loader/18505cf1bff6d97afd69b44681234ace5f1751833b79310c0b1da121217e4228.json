{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport userService from '../services/user.service';\nexport default {\n  name: 'autentificacion',\n  data: () => ({\n    code_form: \"\",\n    status: '',\n    message: ''\n  }),\n  created() {\n    this.getIdentity();\n  },\n  computed: {\n    identity() {\n      return this.$store.getters['admin/getIdentity'];\n    }\n  },\n  methods: {\n    getIdentity: async function () {\n      let response = await this.$store.dispatch(\"admin/getData\");\n      return response;\n    },\n    wait: function () {\n      setTimeout(() => this.$router.go(), 200);\n    },\n    delStatus: function () {\n      setTimeout(() => this.delMsgs(), 1500);\n    },\n    delMsgs: function () {\n      this.status = \"\";\n      this.message = \"\";\n    },\n    async verify() {\n      this.delMsgs();\n      this.getIdentity();\n      let identity = this.identity;\n      let code = String(identity.code);\n      let id = String(identity.sub);\n      let data = {\n        \"id\": code,\n        \"id_user\": id,\n        \"type\": identity.role,\n        \"code\": this.code_form\n      };\n      let result = await this.$store.dispatch(\"main/addItem\", {\n        option: 'session',\n        item: data\n      });\n      console.log(result);\n      if (result.status == 'success') {\n        let ath = await userService.createAuth();\n        if (ath.status == 'success') {\n          await userService.setAth(ath.result);\n          this.$router.push(\"/administrador\").catch(err => {});\n        } else {\n          this.status = 'error';\n          this.message = 'Ha ocurrido un error.';\n          this.delStatus();\n        }\n      } else {\n        this.status = 'error';\n        this.message = 'El codigo no coincide.';\n        this.delStatus();\n      }\n    },\n    async sendCode() {\n      this.delMsgs();\n      this.getIdentity();\n      let identity = this.identity;\n      try {\n        let result = await this.$store.dispatch(\"admin/resendCode\", {\n          \"email\": identity.email,\n          \"name\": identity.name,\n          \"code\": identity.code\n        });\n        if (result.data.status != 'success') {\n          localStorage.removeItem('tkn');\n          this.$router.push(\"/login\").catch(err => {});\n        } else {\n          this.status = 'success';\n          this.message = 'Correo enviado a ' + identity.email;\n          this.delStatus();\n        }\n      } catch (error) {\n        this.status = 'error';\n        this.message = error.message;\n        this.delStatus();\n      }\n    }\n  }\n};","map":{"version":3,"names":["userService","name","data","code_form","status","message","created","getIdentity","computed","identity","$store","getters","methods","response","dispatch","wait","setTimeout","$router","go","delStatus","delMsgs","verify","code","String","id","sub","role","result","option","item","console","log","ath","createAuth","setAth","push","catch","err","sendCode","email","localStorage","removeItem","error"],"sources":["src/views/Autentificacion.vue"],"sourcesContent":["<template>\r\n   <div id=\"login_view\">\r\n      <div class=\"login_cnt\">\r\n\r\n       \r\n\r\n        <div class=\"login_bx\">\r\n\r\n          <div class=\"logo_bx\">\r\n            <img src=\"../assets/login/Logo.svg\" alt=\"Logo SOMA INMOVILIARIA\">\r\n          </div>\r\n\r\n         \r\n            <div class=\"login_frm\">\r\n              <p class=\"text_auth\">Ingresa el código que fue enviado a tu correo electrónico</p>\r\n              <form @submit.prevent=\" verify() \">\r\n                <input \r\n                      id=\"code\" \r\n                      v-model=\"code_form\" \r\n                      type=\"text\" \r\n                      name=\"code\" \r\n                      required\r\n                      placeholder=\"Código\"\r\n                  >\r\n               \r\n                 \r\n                  \r\n                \r\n\r\n               <div class=\"btn_login\">\r\n                <button  type=\"submit\">Verificar</button>\r\n\r\n               </div>\r\n\r\n               <p class=\"form-reenviar-codigo\" >¿Problemas? <span @click=\"sendCode()\"> Solicita un nuevo código aquí</span> </p>\r\n\r\n                <div  class=\"message_error\" v-if=\"status=='error'\">\r\n                    <p>\r\n                      {{this.message}}\r\n                    </p>\r\n                    <img src=\"../assets/default/alert.png\">\r\n                </div>\r\n                <div  class=\"message_error\" v-if=\"status=='success' && this.message\">\r\n                    <p>\r\n                      {{this.message}}\r\n                    </p>\r\n                   \r\n                </div>\r\n              </form>\r\n            </div>\r\n          </div>\r\n\r\n      \r\n\r\n       \r\n        \r\n         \r\n       </div>\r\n    </div>\r\n\r\n</template>\r\n<script>\r\n\r\n\r\nimport userService from '../services/user.service'\r\n\r\nexport default {\r\n  name: 'autentificacion',\r\n  data: () => ({\r\n    code_form: \"\",\r\n    status:'',\r\n    message:''\r\n  }),\r\n  created(){\r\n this.getIdentity()\r\n  },\r\n  computed:{\r\n    identity() {\r\n      return this.$store.getters['admin/getIdentity'];\r\n    },\r\n  },\r\n  methods: {\r\n      getIdentity: async function (){\r\n          let response =  await this.$store.dispatch(\"admin/getData\");\r\n          return response\r\n      },\r\n\r\n    \r\n      \r\n        wait: function () {\r\n      setTimeout(() => this.$router.go(), 200);\r\n    },\r\n     delStatus: function () {\r\n      setTimeout(() => this.delMsgs()\r\n      ,1500);\r\n    },\r\n    delMsgs: function(){\r\n       this.status=\"\"\r\n       this.message=\"\"\r\n    },\r\n\r\n\r\n    async  verify(){\r\n       this.delMsgs()\r\n\r\n        this.getIdentity()\r\n        let identity= this.identity\r\n      \r\n   \r\n          let code = String(identity.code)\r\n          let id = String(identity.sub)\r\n\r\n             let data ={\r\n                \"id\":code,\r\n                \"id_user\":id,\r\n                \"type\":identity.role,\r\n                \"code\":this.code_form\r\n               \r\n              }\r\n\r\n                  \r\n\r\n            let result = await this.$store.dispatch(\"main/addItem\",  {option:'session', item:data});\r\n                   \r\n                  console.log(result)\r\n\r\n\r\n \r\n          if(result.status == 'success'){\r\n             let ath = await userService.createAuth();\r\n\r\n             if(ath.status=='success'){\r\n               await userService.setAth(ath.result);\r\n               this.$router.push(\"/administrador\").catch(err => {});\r\n             }else{\r\n               this.status ='error'\r\n               this.message='Ha ocurrido un error.'\r\n                  this.delStatus()\r\n             }\r\n             \r\n            \r\n       \r\n             \r\n          }else{\r\n            this.status='error' \r\n            this.message='El codigo no coincide.'\r\n            this.delStatus()\r\n          }\r\n          \r\n      },\r\n      \r\n     \r\n\r\n     \r\n      async sendCode() {\r\n        this.delMsgs()\r\n\r\n\r\n         this.getIdentity()\r\n        let identity= this.identity\r\n      try {\r\n        \r\n\r\n      let result =  await this.$store.dispatch(\"admin/resendCode\", {\r\n            \"email\": identity.email,\r\n            \"name\": identity.name,\r\n            \"code\": identity.code\r\n        });\r\n     \r\n\r\n         if(result.data.status !='success'){\r\n            localStorage.removeItem('tkn')\r\n             this.$router.push(\"/login\").catch(err => {});\r\n         }else{\r\n          this.status ='success'\r\n          this.message = 'Correo enviado a '+identity.email\r\n          this.delStatus()\r\n         }\r\n       \r\n      } catch (error) {\r\n        this.status ='error'\r\n        this.message =error.message\r\n        this.delStatus()\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n\r\n<style scoped>\r\n\r\n\r\n#login_view{\r\n    background: linear-gradient(222.39deg, #E40424 12.3%, #9B0016 76.14%);\r\n    height: 100vh;\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n  }\r\n\r\n  .login_cnt{\r\n    background-color: white;\r\n    width: 28.153vw;\r\n    height: auto;\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n    border-radius: 1.047vw;\r\n    padding:  3.715vw  0vw;\r\n  }\r\n  .login_bx{\r\n    width: 20.565vw;\r\n    height: auto;\r\n  }\r\n\r\n  .logo_bx{\r\n    display: flex;\r\n    justify-content: center;\r\n  }.logo_bx img{\r\n    width: 13.710vw;\r\n    height: 8.111vw;\r\n    margin-bottom: 1.884vw;\r\n  }\r\n\r\n  p.text_auth{\r\n    color:rgba(228, 4, 36, 1);\r\n    font-family: var(--montserrat);\r\n    text-align: center;\r\n    margin: 0vw;\r\n    font-weight: 800;\r\n    margin-bottom: 1.832vw;\r\n    font-size: 0.942vw;\r\n  }\r\n  p.form-reenviar-codigo{\r\n    text-align: center;\r\n    color: rgba(87, 86, 86, 1);\r\n    font-size: 0.680vw;\r\n    font-weight: 600;\r\n    margin: 0vw;\r\n    margin-top: 1.936vw;\r\n  }\r\n  p.form-reenviar-codigo span{\r\n   color: rgba(68, 233, 200, 1);\r\n   cursor: pointer;\r\n  }\r\n\r\n\r\n  .login_frm input#code{\r\n    width: 89.7%;\r\n    border-radius: 1.570vw;\r\n    height: 2.721vw;\r\n    margin-bottom: 1.047vw;\r\n    border: 1px solid rgba(87, 86, 86, 1);\r\n    color: rgba(87, 86, 86, 1);\r\n    font-size: 0.680vw;\r\n    font-family: var(--montserrat);\r\n    font-weight: 600;\r\n    padding-left: 1.881vw;\r\n  }\r\n  .login_frm input::placeholder{\r\n    color: rgba(87, 86, 86, 1);\r\n  }\r\n\r\n  .btn_login{\r\n    display: flex;\r\n    justify-content: center;\r\n  }\r\n  .btn_login button{\r\n    background-color: #E40424;\r\n    font-weight: 800;\r\n    font-size: 0.733vw;\r\n    height: 3.140vw;\r\n    width: 16.065vw;\r\n    border: none;\r\n    border-radius: 2vw;\r\n    color: white;\r\n    font-family: var(--montserrat);\r\n    cursor: pointer;\r\n  }\r\n\r\n  .message_error{\r\n    display: flex;\r\n    background-color: #E40424;\r\n    justify-content: space-around;\r\n    align-items: center;\r\n    font-weight: 400;\r\n    font-size: 0.6vw;\r\n    color: white;\r\n    border-radius: 5vw;\r\n    margin-top: .5vw;\r\n    padding: .1vw 0vw;\r\n\r\n  }\r\n  .message_error img{\r\n    width: 1vw;\r\n\r\n  }\r\n\r\n@media (max-width: 768px) {\r\n    #login_view{\r\n      align-items: start;\r\n    }\r\n    .login_cnt{\r\n      width: 100vw;\r\n      border-radius: 0vw;\r\n      padding-top: 10.769vw;\r\n      padding-bottom: 19.231vw;\r\n   }\r\n   .login_bx{\r\n     width: 70.049vw;\r\n   }\r\n\r\n   .logo_bx img{\r\n     width: 51.282vw;\r\n     height: 30.256vw;\r\n     margin-bottom: 3.333vw;\r\n   }\r\n  \r\n   .login_frm input#code{\r\n    height: 12.869vw;\r\n    font-size: 3.333vw;\r\n    padding-left: 6.336vw;\r\n    border-radius: 10vw;\r\n    margin-bottom: 4.818vw;\r\n   }\r\n\r\n   p.text_auth{\r\n   margin-bottom: 4.103vw;\r\n    font-size: 3.590vw;\r\n    margin-top: 4vw;\r\n  }\r\n  p.form-reenviar-codigo{\r\n  \r\n    font-size: 3.846vw;\r\n    \r\n    margin-top: 9.744vw;\r\n  }\r\n  p.form-reenviar-codigo span{\r\n    display: block;\r\n  width: 100%;\r\n}\r\n\r\n\r\n    .btn_login button {\r\n      height:12.821vw;\r\n      width: 100vw;\r\n      border-radius: 10vw;\r\n      font-size: 3.590vw;\r\n    }\r\n\r\n    .message_error{\r\n      height:6.821vw;\r\n      font-size: 2.333vw;\r\n      margin-top: 2vw;\r\n    }\r\n\r\n    .message_error img {\r\n      width: 2.622vw;\r\n}\r\n\r\n\r\n  }\r\n\r\n</style>\r\n"],"mappings":";AAgEA,OAAAA,WAAA;AAEA;EACAC,IAAA;EACAC,IAAA,EAAAA,CAAA;IACAC,SAAA;IACAC,MAAA;IACAC,OAAA;EACA;EACAC,QAAA;IACA,KAAAC,WAAA;EACA;EACAC,QAAA;IACAC,SAAA;MACA,YAAAC,MAAA,CAAAC,OAAA;IACA;EACA;EACAC,OAAA;IACAL,WAAA,iBAAAA,CAAA;MACA,IAAAM,QAAA,cAAAH,MAAA,CAAAI,QAAA;MACA,OAAAD,QAAA;IACA;IAIAE,IAAA,WAAAA,CAAA;MACAC,UAAA,YAAAC,OAAA,CAAAC,EAAA;IACA;IACAC,SAAA,WAAAA,CAAA;MACAH,UAAA,YAAAI,OAAA,IACA;IACA;IACAA,OAAA,WAAAA,CAAA;MACA,KAAAhB,MAAA;MACA,KAAAC,OAAA;IACA;IAGA,MAAAgB,OAAA;MACA,KAAAD,OAAA;MAEA,KAAAb,WAAA;MACA,IAAAE,QAAA,QAAAA,QAAA;MAGA,IAAAa,IAAA,GAAAC,MAAA,CAAAd,QAAA,CAAAa,IAAA;MACA,IAAAE,EAAA,GAAAD,MAAA,CAAAd,QAAA,CAAAgB,GAAA;MAEA,IAAAvB,IAAA;QACA,MAAAoB,IAAA;QACA,WAAAE,EAAA;QACA,QAAAf,QAAA,CAAAiB,IAAA;QACA,aAAAvB;MAEA;MAIA,IAAAwB,MAAA,cAAAjB,MAAA,CAAAI,QAAA;QAAAc,MAAA;QAAAC,IAAA,EAAA3B;MAAA;MAEA4B,OAAA,CAAAC,GAAA,CAAAJ,MAAA;MAIA,IAAAA,MAAA,CAAAvB,MAAA;QACA,IAAA4B,GAAA,SAAAhC,WAAA,CAAAiC,UAAA;QAEA,IAAAD,GAAA,CAAA5B,MAAA;UACA,MAAAJ,WAAA,CAAAkC,MAAA,CAAAF,GAAA,CAAAL,MAAA;UACA,KAAAV,OAAA,CAAAkB,IAAA,mBAAAC,KAAA,CAAAC,GAAA;QACA;UACA,KAAAjC,MAAA;UACA,KAAAC,OAAA;UACA,KAAAc,SAAA;QACA;MAKA;QACA,KAAAf,MAAA;QACA,KAAAC,OAAA;QACA,KAAAc,SAAA;MACA;IAEA;IAKA,MAAAmB,SAAA;MACA,KAAAlB,OAAA;MAGA,KAAAb,WAAA;MACA,IAAAE,QAAA,QAAAA,QAAA;MACA;QAGA,IAAAkB,MAAA,cAAAjB,MAAA,CAAAI,QAAA;UACA,SAAAL,QAAA,CAAA8B,KAAA;UACA,QAAA9B,QAAA,CAAAR,IAAA;UACA,QAAAQ,QAAA,CAAAa;QACA;QAGA,IAAAK,MAAA,CAAAzB,IAAA,CAAAE,MAAA;UACAoC,YAAA,CAAAC,UAAA;UACA,KAAAxB,OAAA,CAAAkB,IAAA,WAAAC,KAAA,CAAAC,GAAA;QACA;UACA,KAAAjC,MAAA;UACA,KAAAC,OAAA,yBAAAI,QAAA,CAAA8B,KAAA;UACA,KAAApB,SAAA;QACA;MAEA,SAAAuB,KAAA;QACA,KAAAtC,MAAA;QACA,KAAAC,OAAA,GAAAqC,KAAA,CAAArC,OAAA;QACA,KAAAc,SAAA;MACA;IACA;EACA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}